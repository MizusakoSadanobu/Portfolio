
### これは何か
- **画像アノテーションを行う団体**の品質を評価するためのディープラーニング（畳み込みニューラルネットワーク及びメトリックラーニング）モデルの開発を行ったものです

### なぜ分析したのか
- AI Scholarが主催する[ハッカソン](https://ai-scholar.tech/events/ai_hackathon)で出題された次の課題を解決するために分析を行いました
- 背景：
	- 画像データをAfghan Hound、Fried Chickenなど、全11クラスにアノテーションするというタスクを、３組のアノテーション団体に依頼した
	- アノテーション団体には同じタスクを依頼したが、渡した画像データはそれぞれ異なる（1団体につき2000枚ほど）
	- アノテーション団体毎に異なるアノテーションの誤り率が設定されている（今回の裏設定では、0%、5%、20%でした）
- 課題：
	- 作業団体、作業者のアノテーションの精度を評価するには「確からしさ」と「コスト」のトレードオフがある
	- アノテーション作業の一部チェックするとして、チェックする割合が多ければ多いほど正しく評価できるが、その分コストが上がる
	- よって、**アノテーション団体の良し悪しをデータから評価したい**

### どのように分析したのか
- 正解が分かっているFashion MNISTのデータセットを使い手法の良し悪しを評価し、今回のハッカソンのデータセットに適用してアノテーション団体の評価を行いました

- 思考過程など含め開発内容を[発表用スライド](https://docs.google.com/presentation/d/e/2PACX-1vQll9MGEJFK4LfeB6oiYRUU-5b8NhiEXDPkIbRYbeMRvi0dwdzlRex39PB-ZrBGEcRK1r6yfscSFOlb/pub?start=false&loop=false&delayms=3000)にまとめていますので、ここではスライドの一部を使って概略を説明したいと思います

- まず、「ミスの少ないアノテーターの効率良い選定」という課題に対して、それを解決するための分析上の問題設定として、**1. ミスのあるデータの特定**、**2. ミスの件数の推定**、**3. 団体間でのミスの多寡（多さ少なさ）の推定**、という3つを考えました

![](http://drive.google.com/uc?export=view&id=15JItusXiJrofAIsey8EXwbIBry1gk49k)

- 関連手法をサーベイしてみたところ、畳み込みニューラルネット（CNN）、メトリックラーニング、異常検知などの手法が使えそう、と感触を持ちました

![](http://drive.google.com/uc?export=view&id=1R8I3h6rseeVsV8TNXFTJ-Ba3YB2DHLHu)

- 今回はMovileNetV2\*をベースに、以下3つのモデルを試してみました
	- \*ハッカソン発表後に、審査員からコメントもらいましたが、学習用のデータセットが少ない場面（今回はデータ数6000件程度）では、パラメータ数が多いMobileNetV2は適さないようです。。

![](http://drive.google.com/uc?export=view&id=1x1wGJqGMCXGoV49p32Nn3uxVCFSY_GZY)

- Fashion MNISTのデータセットを使って手法の検証を行ったところ、①MovileNetV2を使ったシンプルな分類モデルと、②MovileNetV2にL2 Softmax層を加えたメトリックラーニングのモデルのパフォーマンスがよいことが分かりました

![](http://drive.google.com/uc?export=view&id=1mJ8Wo2XtQaLxF6ewE7J2nBlkGdV5LP8m)

- 上記とは別の数値実験では、②のモデルの方がパフォーマンスが良さそうでしたので、ハッカソンのデータセットの評価には②のモデルを採用することにしました。以下の手順でデータセットの評価を行い、結果を提出しました

![](http://drive.google.com/uc?export=view&id=1SJb2V6BFUizJqsXWmozuzMD34LszJ9Hq)

### 最後に
- 今回はじめてkerasを使って画像分類モデルを組んだこともあり、審査では多くのツッコミをいただきました。特に、上記でも示したモデル選定の考え方は、実務上、とてもクリティカルだと思いました
- 一方、幸いなことに、仮説検証のプロセスを評価いただき、優秀賞（1位）をいただくことができました。これを機にディープラーニングを使った手法もいろいろと試してみたいと思います



<!--stackedit_data:
eyJoaXN0b3J5IjpbNzg0NzQyODQ1LDczMDk5ODExNl19
-->